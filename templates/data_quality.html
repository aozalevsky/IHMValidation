{% extends "layout.html" %}

<!-- Template for writing data quality webpage -->
<!-- ganesans - Salilab - UCSF -->
<!-- ganesans@salilab.org -->

{% block body %}

                                                            <!-- scripts -->
                                                            <script>
                                                                function Write_Table(list_to_write) {
                                                                    var mytable = "<div class='bs-example' class='text-center'> <table class='table table-bordered' style='border-color':#003366;> <thead> <tr>";
                                                                    for (var i = 0; i < list_to_write[0].length; i++) {
                                                                        mytable += "<th align='center' class='text-center' style='vertical-align:middle'>" + list_to_write[0][i] + "</th>";
                                                                    }
                                                                    mytable += "</tr></thead><tr>";

                                                                    for (var j = 1; j < list_to_write.length; j++) {
                                                                        for (var i = 0; i < list_to_write[j].length; i++) {
                                                                            mytable += "<td><div>" + list_to_write[j][i] + "</div></td>";
                                                                        }
                                                                        mytable += "</tr><tr>";

                                                                    }
                                                                    mytable += "</tr></table></div>";
                                                                    document.write(mytable);
                                                                }
                                                            </script>
                                                            <!-- scripts -->
                                                            <div class="card-body border-success" style="border-color: solid black;">
                                                                <!-- start overall card body for front page -->
                                                                <div class="card-header" style="background-color: #FFF;">
                                                                    <div class="row">
                                                                        <div class="col-lg-12">
                                                                            <h4 class="ex2" align="center"><u><a name='first'>Data quality</a></u><a class='help' title='help' style='background-color:#228B22;color:#000000;text-decoration:none font-size=16px' href='../../../validation_help.html#dataquality'>?</a></h4>
                                                                            <script>
                                                                                if ({{sas}}.length > 0 && {{sasdb_sascif}}.length > 0 ) {
                                                                                    var ex = "<h5 class= ex2 align= center><u><a name=firstI>SAS:Scattering profile</a></u><a class='help' title='help' style='background-color:#228B22;color:#000000;text-decoration:none font-size=16px' href='../../../validation_help.html#scattering'>?</a> </h5>";
                                                                                    document.write(ex)
                                                                                    var sasdb_code_html={{sasdb_code_html}}     
                                                                                    var ex2 = '<p align=justify> SAS data used in this integrative model was obtained from '+String(sasdb_code_html.length) +' deposited SASBDB entry (entries).</p>';
                                                                                    document.write(ex2);

                                                                                } else if ({{sas}}.length > 0 && {{sasdb_sascif}}.length <1) {

                                                                                    var ex = "<h5 class= ex2 align= center><u><a name=firstI>SAS:Scattering profile</a></u> </h5>";
                                                                                    document.write(ex)
                                                                                    var ex2 = '<p align=justify> SAS data used in this integrative model could not be validated as the sascif file is currently unavailable. </p>';
                                                                                    document.write(ex2);

                                                                                } 
                                                                            </script>
                                                                        </div>
                                                                    </div>

                                                                    <script>
                                                                        if ({{sas}}.length > 0 && {{sasdb_sascif}}.length > 0) {
                                                                            var sasdb_code_html={{sasdb_code_html}}     
                                                                            for (var i = 0; i < sasdb_code_html.length; i++) {
                                                                                var ex3 ='<p align=justify> <u> Scattering profile for <a href=https://www.sasbdb.org/data/' + sasdb_code_html[i] + '/> '+ sasdb_code_html[i]+'</a>:</u> data from solutions of biological macromolecules are presented as both log I(q) vs q and log I(q) vs log (q) based on <a href=https://salilab.org/pdf/Trewhella_ActaCrystD_2017.pdf>SAS validation task force (SASvtf) recommendations.</a> I(q) is the intensity (in arbitrary units) and q is the modulus of the scattering vector. </p>'; 
                                                                                document.write(ex3)

                                                                                var ex4 ='<div class=row> <div class=col-lg-6> <div class=box text-center container-fluid no-padding style=height:60vh>';
                                                                                ex4 +='<iframe src=../images/' + {{ID_w}} + sasdb_code_html[i]+'intensities.html frameborder=0 scrolling=yes width=100% height=550vh  style=position:relative></iframe>'
                                                                                document.write(ex4)

                                                                                var ex5 ='</div></div> <div class=col-lg-6><div class=box text-center container-fluid no-padding style=height:60vh >';
                                                                                ex5 += '<iframe src=../images/' + {{ID_w}} + sasdb_code_html[i]+'intensities_log.html frameborder=0 scrolling=yes width=100% height=550vh  style=position:relative></iframe>';
                                                                                document.write(ex5)
                                                                                var ex6 ='</div></div> </div>';
                                                                                ex6 +='<p style=margin-bottom:3cm;> </p>';
                                                                                document.write(ex6)
                                                                            }
                                                                        }
                                                                    </script>

                                                                    <p style="margin-bottom:1cm;"> </p>
                                                                </div>
                                                            </div>
                                                            <div class="card-body border-success" style="border-color: solid black;">
                                                                <!-- start overall card body for front page -->
                                                                <div class="row">
                                                                    <div class="col-lg-12">
                                                                        <div class="card-header" style="background-color: #FFF;">
                                                                            <script>
                                                                                if ({{sas}}.length > 0 && {{sasdb_sascif}}.length > 0) {
                                                                                    var ex1 = "<h5 class= ex2 align= center> <u><a name=firstE>Key experimental estimates</a></u><a class='help' title='help' style='background-color:#228B22;color:#000000;text-decoration:none font-size=16px' href='../../../validation_help.html#expt'>?</a></h5>";
                                                                                    ex1 +='<p style=margin-bottom:0.5cm;> </p>';

                                                                                    ex1 += "<p class=ex2 align='justify'><u>Molecular weight (MW) estimates from experiments and analysis</u>: true molecular weight can be compared to the Porod estimate from scattering profiles. </p>";
                                                                                    document.write(ex1);
                                                                                    var input_list = {{parameters_mw}};
                                                                                    Write_Table(list_to_write = input_list)
                                                                                    var ex11 ='<p style=margin-bottom:0.5cm;> </p>';

                                                                                    ex11 += "<p class=ex2><u>Volume estimates from experiments and analysis</u>: estimated volume can be compared to Porod volume obtained from scattering profiles.</p>";
                                                                                    document.write(ex11)
                                                                                    var input_list = {{parameters_volume}};
                                                                                    Write_Table(list_to_write = input_list)
                                                                                }
                                                                            </script>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="card-body border-success" style="border-color: solid black;">
                                                                <!-- start overall card body for front page -->
                                                                <div class="card-header" style="background-color: #FFF;">
                                                                    <div class="row">
                                                                        <div class="col-lg-12">
                                                                            <script>
                                                                                if ({{sas}}.length > 0 && {{sasdb_sascif}}.length > 0) {

                                                                                    var ex2 = "<h5 class= ex2 align= center><u><a name=firstF> Flexibility analysis</a> </u><a class='help'  title='help' style='background-color:#228B22;color:#000000;text-decoration:none font-size=16px' href='../../../validation_help.html#flexibility'>?</a></h5>";
                                                                                    document.write(ex2)
                                                                                }
                                                                            </script>
                                                                        </div>
                                                                    </div>

                                                                    <script>
                                                                        if ({{sas}}.length > 0 && {{sasdb_sascif}}.length > 0) {
                                                                            var sasdb_code_html={{sasdb_code_html}}     
                                                                            for (var i = 0; i < sasdb_code_html.length; i++) {
                                                                                var ex3 ='<p align=justify> <u> Flexibility analysis for '+ sasdb_code_html[i]+'</u>: In a Porod-Debye plot, a clear plateau is observed for globular (partial or fully folded) domains, whereas, fully unfolded domains are devoid of any discernable plateau. For details, refer to Figure 5 in <a href=https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3103662/>Rambo and Tainer, 2011</a>. In a Kratky plot, a parabolic shape is observed for globular (partial or fully folded) domains and a hyperbolic shape is observed for fully unfolded domains. </p>'; 
                                                                                document.write(ex3)

                                                                                var ex4 ='<div class=row> <div class=col-lg-6> <div class=box text-center container-fluid no-padding style=height:60vh>';
                                                                                ex4 +='<iframe src=../images/' + {{ID_w}} + sasdb_code_html[i]+'porod.html frameborder=0 scrolling=yes width=100% height=550vh  style=position:relative></iframe>'
                                                                                document.write(ex4)

                                                                                var ex5 ='</div></div> <div class=col-lg-6><div class=box text-center container-fluid no-padding style=height:60vh >';
                                                                                ex5 += '<iframe src=../images/' + {{ID_w}} + sasdb_code_html[i]+'Kratky.html frameborder=0 scrolling=yes width=100% height=550vh  style=position:relative></iframe>';
                                                                                document.write(ex5)
                                                                                var ex6 ='</div></div> </div>';
                                                                                ex6 +='<p style=margin-bottom:3cm;> </p>';
                                                                                document.write(ex6)
                                                                            }
                                                                        }
                                                                    </script>

                                                                    <p style="margin-bottom:3cm;"> </p>
                                                                </div>
                                                            </div>           
                                                            <div class="card-body border-success" style="border-color: solid black;">
                                                                <!-- start overall card body for front page -->
                                                                <div class="card-header" style="background-color: #FFF;">
                                                                    <div class="row">
                                                                        <div class="col-lg-12">
                                                                            <script>
                                                                                if ({{sas}}.length > 0 && {{sasdb_sascif}}.length > 0) {
                                                                                    var ex2 = "<h5 align= center><u><a name=firstP>Pair-distance distribution analysis</a></u><a class='help' title='help' style='background-color:#228B22;color:#000000;text-decoration:none font-size=16px' href='../../../validation_help.html#pofr'>?</a></h5>";
                                                                                    document.write(ex2)
                                                                                    var ex3 ='<p style=margin-bottom:0.5cm;> </p>';

                                                                                    ex3 += "<p class=ex2 align='justify'><u> P(r) analysis:</u> P(r) represents the distribution of distances between all pairs of atoms within the particle weighted by the respective electron densities. P(r) is the Fourier transform of I(s) (and vice versa). R<sub>g</sub> can be estimated from integrating the P(r) function. Agreement between the P(r) and Guinier-determined R<sub>g</sub> (table below) is a good measure of the self-consistency of the SAS profile. R<sub>g</sub> is a measure for the overall size of a macromolecule; e.g. a protein with a smaller R<sub>g</sub> is more compact than a protein with a larger R<sub>g</sub>, provided both have the same molecular weight (MW). The point where P(r) is decaying to zero is called D<sub>max</sub> and represents the maximum size of the particle.</p>";
                                                                                    ex3 +='<p style=margin-bottom:0.5cm;> </p>';
                                                                                    document.write(ex3);
                                                                                    var input_list = {{pddf_info}};
                                                                                    Write_Table(list_to_write = input_list)
                                                                                }
                                                                            </script>
                                                                        </div>
                                                                    </div>
                                                                    <script>
                                                                        if ({{sas}}.length > 0 && {{sasdb_sascif}}.length > 0) {
                                                                            var sasdb_code_html={{sasdb_code_html}}     
                                                                            for (var i = 0; i < sasdb_code_html.length; i++) {
                                                                                var ex3 ='<p align=justify> <u> P(r) for '+ sasdb_code_html[i]+':</u> The value of P(r) should be zero beyond r=D<sub>max</sub>. </p>'; 
                                                                                document.write(ex3)
                                                                                var ex4 ='<div class=row> <div class=col-lg-6> <div class=box text-center container-fluid no-padding  style=height:60vh>';
                                                                                ex4 +='<iframe src=../images/' + {{ID_w}} + sasdb_code_html[i]+'pddf.html frameborder=0 scrolling=yes width=100% height=550vh  style=position:relative></iframe>'
                                                                                document.write(ex4)

                                                                                var ex5 ='</div></div> <div class=col-lg-6><div class=box text-center container-fluid no-padding style=height:60vh >';
                                                                                ex5 += '<iframe src=../images/' + {{ID_w}} + sasdb_code_html[i]+'pddf_int.html frameborder=0 scrolling=yes width=100% height=550vh  style=position:relative></iframe>';
                                                                                document.write(ex5)

                                                                                var ex6 ='</div></div> </div>';
                                                                                ex6 +='<p style=margin-bottom:3cm;> </p>';
                                                                                document.write(ex6)
                                                                            }
                                                                        }
                                                                    </script>

                                                                    <p style="margin-bottom:3cm;"> </p>

                                                                    <script>
                                                                        if ({{sas}}.length > 0 && {{sasdb_sascif}}.length > 0) {
                                                                            var sasdb_code_html={{sasdb_code_html}}     
                                                                            for (var i = 0; i < sasdb_code_html.length; i++) {
                                                                                var ex3 ='<p align=justify> <u> Residuals and error weighted residuals for P(r) analysis for  '+ sasdb_code_html[i]+'</u>: Residual value plot is a measure to assess fit to the data. Residual values should be equally and randomly spaced around the horizontal axis.</p>'; 
                                                                                document.write(ex3)

                                                                                var ex4 ='<div class=row> <div class=col-lg-6> <div class=box text-center container-fluid no-padding style=height:60vh>';
                                                                                ex4 +='<iframe src=../images/' + {{ID_w}} + sasdb_code_html[i]+'pddf_residuals.html frameborder=0 scrolling=yes width=100% height=550vh  style=position:relative></iframe>'
                                                                                document.write(ex4)

                                                                                var ex5 ='</div></div> <div class=col-lg-6><div class=box text-center container-fluid no-padding style=height:60vh >';
                                                                                ex5 += '<iframe src=../images/' + {{ID_w}} + sasdb_code_html[i]+'pddf_residuals_wt.html frameborder=0 scrolling=yes width=100% height=550vh  style=position:relative></iframe>';
                                                                                document.write(ex5)
                                                                                var ex6 ='</div></div> </div>';
                                                                                ex6 +='<p style=margin-bottom:3cm;> </p>';
                                                                                document.write(ex6)
                                                                            }
                                                                        }
                                                                    </script>

                                                                    <p style="margin-bottom:3cm;"> </p>


                                                                </div>
                                                            </div>

                                                            <div class="card-body border-success" style="border-color: solid black;">
                                                                <!-- start overall card body for front page -->
                                                                <div class="card-header" style="background-color: #FFF; height=108rem">
                                                                    <div class="row">
                                                                        <div class="col-lg-12">
                                                                            <script>
                                                                                if ({{sas}}.length > 0 && {{sasdb_sascif}}.length > 0) {
                                                                                    var ex2 = "<h5 class= ex2 align= center><u><a name=firstG> Guinier analysis </a></u><a class='help' title='help' style='background-color:#228B22;color:#000000;text-decoration:none font-size=16px' href='../../../validation_help.html#guinier'>?</a></h5>";
                                                                                    document.write(ex2)
                                                                                    var ex3 ='<p style=margin-bottom:0.5cm;> </p>';
                                                                                    ex3 += "<p class=ex2 align='justify'><u> Guinier analysis:</u> agreement between the P(r) and Guinier-determined R<sub>g</sub> (table below) is a good measure of the self-consistency of the SAS profile. Molecular weight estimates can also be compared to Porod and sample molecular weights for consistency.</p>";
                                                                                    ex3 +='<p style=margin-bottom:0.5cm;> </p>';
                                                                                    document.write(ex3);
                                                                                    var input_list = {{rg_table}};
                                                                                    Write_Table(list_to_write = input_list)
                                                                                }
                                                                            </script>
                                                                        </div><!-- end col -->
                                                                    </div>

                                                                    <script>
                                                                        if ({{sas}}.length > 0 && {{sasdb_sascif}}.length > 0) {
                                                                            var sasdb_code_html={{sasdb_code_html}}     
                                                                            for (var i = 0; i < sasdb_code_html.length; i++) {
                                                                                var ex3 ='<p align=justify> <u> Guinier analysis for '+ sasdb_code_html[i]+': </u> the linearity of the Guinier plot is a sensitive indicator of the quality of the experimental SAS data; a linear Guinier plot is a necessary but not sufficient demonstration that a solution contains monodisperse particles of the same size. Deviations from linearity usually point to strong interference effects, polydispersity of the samples or improper background subtraction. Residual value plot and coefficient of determination (R<sup>2</sup>) are measures to assess linear fit to the data. A perfect fit has an R<sup>2</sup> value of 1. Residual values should be equally and randomly spaced around the horizontal axis. </p>';
                                                                                document.write(ex3)

                                                                                var ex4 ='<div class=row> <div class=col-lg-6> <div class=box text-center container-fluid no-padding style=height:60vh>';
                                                                                ex4 +='<iframe src=../images/' + {{ID_w}} + sasdb_code_html[i]+'guinier.html frameborder=0 scrolling=yes width=100% height=550vh  style=position:relative></iframe>'
                                                                                document.write(ex4)

                                                                                var ex5 ='</div></div> <div class=col-lg-6><div class=box text-center container-fluid no-padding style=height:60vh >';
                                                                                ex5 += '<iframe src=../images/' + {{ID_w}} + sasdb_code_html[i]+'guinier_residuals.html frameborder=0 scrolling=yes width=100% height=550vh  style=position:relative></iframe>';
                                                                                document.write(ex5)
                                                                                var ex6 ='</div></div> </div>';
                                                                                ex6 +='<p style=margin-bottom:3cm;> </p>';
                                                                                document.write(ex6)
                                                                            }
                                                                        }
                                                                    </script>
                                                                    <p style="margin-bottom:3cm;"> </p>
                                                                </div> <!-- end card body-->
                                                            </div>

                                                            <!-- start overall card body for front page -->
                                                            <!-- start overall card body for front page -->
                                                            <!-- start overall card body for front page -->
{% endblock %}
